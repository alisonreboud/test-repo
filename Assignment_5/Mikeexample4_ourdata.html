<html>
<head>
  <title>San Francisco Crime Map</title>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="sfpd_districts.geojson"></script>
  <script src="sf_crime.geojson"></script>
  <style>
  .contentDiv {
    background-color: "#caf0fb";
    height: 200px;
    position: bottom;
    width: 200px;
}

@keyframes bouncing {
    0% {bottom: 0;}
    50% {bottom: 20px;}
    100% {bottom: 0;}
}

.arrow {
    animation: bouncing 1s infinite ease-in-out;
    bottom: 0;
    display: block;
    height: 80px;
    left: 90%;
    margin-left: -25px;
    position: absolute;
    width: 80px;
}
  </style>
</head>
<body style="background-color: #caf0fb;">
  <div id="titles">
  <h1 align="center"> Assignment 5: Crime of San Francisco, 1/1/2003-13/5/2015 </h1>
  <h2 align="center"> By Alison Reboud, Thomas Schleider & Karina O'Neill </h2>
  </div>
  <div id="container1">
  <div id="sfmap" style="float: left; font-size: 20px; width: 48%;">
    <h3>Interactive Map Visualisation</h3>
  <script>
var width = 840,
    height = 696;
var svg = d3.select( "body" )
  .append( "svg" )
  .attr( "width", width )
  .attr( "height", height );
var sfpd_districts = svg.append( "g" );
var albersProjection = d3.geo.albers()
  .scale( 250000 )
  .rotate( [122.419,0] )
  .center( [0, 37.775] )
  .translate( [width/2,height/2.5] );
var geoPath = d3.geo.path()
    .projection( albersProjection );
sfpd_districts.selectAll( "path" )
  .data( sfpd_districts_geojson.features )
  .enter()
  .append( "path" )
  .attr( "fill", "#72d26f" )
  .attr( "d", geoPath );
var crimes = svg.append( "g" );
crimes.selectAll( "path" )
  .data( sf_crime_geojson.features )
  .enter()
  .append( "path" )
  .attr( "fill", "#900" )
  .attr( "stroke", "#999" )
  //.attr("r", 0.1)
  .attr( "d", geoPath )
  .on("mouseover", 
            function(d) {
              d3.select(this).attr("fill", "#999");
            })
        .on("mouseout", 
            function(d) {
              d3.select(this).attr("fill", "#900");
            })

  </script>
  </div>
     <div id="barchart" style="float: right; font-size: 20px; width: 48%;">
       <h3>Bar Chart Visualisation by Day of the Week</h3>
    <script>
      var dataset;

d3.csv("sf_crime.csv", function(d) {
  return {
    DayOfWeek: new Date(d.DayOfWeek),
    Category: d.Category
  };
}, 

function(error, rows) {
    dataset = rows;
    var counts = {};
rows.forEach(function(r) {
    var key = r.DayOfWeek + r.Category;
    if (!counts[key]) {
        counts[key] = {
           dayofweek: r.DayOfWeek,
           category: r.Category,
           count: 0
        };
    }
    counts[key].count++;
});

var data = [];
Object.keys(counts).forEach(function(key) {
    data.push(counts[key]);
});   
});

      console.log(data)
      
    </script>
  </div>
    <div class="contentDiv" style="float: right">
    <img class="arrow" src="https://cdn3.iconfinder.com/data/icons/google-material-design-icons/48/ic_keyboard_arrow_down_48px-128.png" />
    </div>
    </div>
    <div id="container2">
        <div id="findingstext1">
          <h3>Findings:</h3>
          <p>The map shows that...</p>
          <p>The bar chart shows that...</p>
      </div>
  </div>
</body>
</html>
